# h5 Injected Sequel

Kone millä tein harjoituksen:

AMD Ryzen 2600X Six-Core Processor 3.6 ghz  

16gb RAM  

Windows 10 Pro 64-bit käyttöjärjestelmä  

Oracle VM VirtualBox Manager

##

Läksy löytyy sivulta:  

https://terokarvinen.com/2023/eettinen-hakkerointi-2023/  

## x) Lue ja tiivistä  

#### https://terokarvinen.com/2016/03/05/postgresql-install-and-one-table-database-sql-crud-tutorial-for-ubuntu/


PostgreSQL Install and One Table Database – SQL CRUD tutorial for Ubuntu  

PostgreSQL tietokannan voi asentaa muutamalla rivillä:  

- `$ sudo apt-get -y install postgresql`
- `$ sudo systemctl start postgreql`
- `$ sudo -u postgres createdb $(whoami)`
- `$ sudo -u postgres createuser $/whoami)`
- `$ psql`  

#### https://owasp.org/www-project-top-ten/2017/A1_2017-Injection  
  
- Melkein minkä tyyppinen data tahansa voidaan käyttää harmilliseen injektioon  
- Usein injektio haavoittuvuudet on SQL, LDAP, XPath, NoSQL qweryt, OS komennot, XML parserit, SMTP headerit, expressio kieliet ja ORM queryt.  
-  Scannereilla ja fuzzereilla hyökkääjät löytää helposti injektio haavoittuvuuksia
-  Onnistunut haitallinen injektio voi johtaa datan menettämiseen, korruptoitumiseen, pääsyyn vääriin käsiin, kokonaiseen "takeoveriin"

#### https://portswigger.net/web-security/sql-injection  

- sql injektio on weppi turvallisuus-haavoittuvuus joka antaa hyökkääjän interferoida pyyntöjen kanssa mitä applikaatio tekee tietokannalle
- antaa hyökkääjälle mahdollisuuden nähdä dataa mitä ei muuten voisi nähdä
- mahdollisuuksia löytää haavoittuvuuksia (') `OR 1=1`, payloadit & suoritusajat
-  usein tapahtuu WHERE clausella SELECT querysta  mutta voi tapahtua muuallakin

#### https://portswigger.net/web-security/sql-injection/cheat-sheet  

- esimerkkejä hyödyllisistä syntaxeista SQL injektioita varten

## a) CRUD. Tee uusi PostgreSQL-tietokanta ja demonstroi sillä create, read, update, delete (CRUD). Keksi taulujen ja kenttien nimet itse. Taulujen nimet monikossa, kenttien nimet yksikössä, molemmat englanniksi.  

https://terokarvinen.com/2016/03/05/postgresql-install-and-one-table-database-sql-crud-tutorial-for-ubuntu/ käytin kyseistä artikkelia ohjeena tässä tehtävässä.  

`$ sudo apt-get update`  
`$ sudo apt-get -y install postgresql  
`$ sudo systemctl start postgresql`  
`$ sudo -u postgres createdb $(whoami)`    

Tähän tyssäs tuli virheilmoitus:  

![image](https://github.com/aarott/pentest23/assets/78908566/8927d719-06b9-4e84-aec3-420730135ddd)  

Menin /home kansiosta pois. Tein uuden postgresq kansion (vaikka en usko et tällaista tarvitseekaan)...  

`$ sudo mkdir postgresq`  
`$ sudo cd postgresq` 
`$ sudo -u postgres createdb $(whoami)`   

Nyt tuli ilmoitus että tällainen tietokanta on jo, käytetään sitten sitä.  

`$ psql`   

##  

![image](https://github.com/aarott/pentest23/assets/78908566/b52cae71-f4d0-4865-a376-926d1effdd39)  

##

![image](https://github.com/aarott/pentest23/assets/78908566/5c50e8fe-5b91-4f47-9455-075975fe10fa)  

Yritin lisätä tehdä uutta tablea mutta tulee ilmoitus "ERROR: permission denied for schema public".  

En löydä oikeen tapaa miten saada omalle käyttäjälleni oikeuksia käyttää postgresq tietokantaa, päätäin sitten kokeilla "postgresq" käyttäjällä. 

Etsin tietoa vähän ympäriinsä ja löysin artikkelin https://www.configserverfirewall.com/postgresql/installing-postgresql-on-ubuntu/   

`$ sudo su postgres`
`$ psql`  

`CREATE TABLE cars (id SERIAL PRIMARY KEY, brand VARCHAR(200), model VARCHAR(200);`  --> tää vihdoiin toimi ja siiryin tauolle  

Tässä välissä kokeilin vanhasta muistista lisäillä kenttiä  taulusta, tein virheitä ja en huomannut ottaa ruutukaappauksia. Siksi seuraavassa kuvassa taulukon id:t alkaa 4:sta koska poistin aiemmat 3.  

`\d` -> listaa relaatiot


##

![image](https://github.com/aarott/pentest23/assets/78908566/e2520c0f-47f2-4d30-abed-14a8707495ea)  

##  

Muokkasin ja poistin kenttiä:  

![image](https://github.com/aarott/pentest23/assets/78908566/ca31c8dc-03a6-48ad-9dd4-d8cd58d61368)  

## b) SQLi me. Kuvaile yksinkertainen SQL-injektio, ja demonstroi se omaan tietokantaasi psql-komennolla. Selitä, mikä osa on käyttäjän syötettä ja mikä valmiina ohjelmassa. (Tässä harjoituksessa voit vain kertoa koodista, ei siis tarvitse välttämättä koodata sitä ohjelmaa, joka yhdistää käyttäjän syötteen SQL:n)














